---
title: "Iterated Prisioner's Dilemma"
author: "SÃ©rgio Rivero"
date: "`r Sys.time()`"
output:
  html_document:
    number_sections: TRUE
  pdf_document:
    number_sections: TRUE

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning = FALSE, eval = TRUE)

### Generating the simulation Results
rm(list=ls())
```


```{r loadLibs}

### Getting the Libraries
library(tidyverse)

```


```{r setupDirs}

### Setting up the Directories
i  <-  "runs"
o  <-  "results"
```



```{r getFiles}

### Getting the files 
csv_files <- fs::dir_ls(i, regexp = "\\.csv$")

```



```{r generatingDF}

### Generating runs dataframe

runs_df  <- csv_files %>%
    map_dfr(read_csv)
runs_df_or  <-  runs_df
runs_df  <- runs_df[complete.cases(runs_df),]

runs_df$diff_payoffs  <- runs_df$my_payoff - runs_df$other_payoff


```

```{r}
sum_runs <- runs_df %>% group_by(scenario, step, strategy_name) %>% 
  summarise(payoff = mean(my_payoff, na.rm = T)) 

sum_runs %>%  ggplot(aes(x=step, y = payoff, color = strategy_name)) + geom_point() + geom_smooth()
```
