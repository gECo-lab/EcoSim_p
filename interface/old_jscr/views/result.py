from flask import Blueprint, send_file, render_template
from common.database import Database

result_blueprint = Blueprint('result', __name__)


@result_blueprint.route(
    rule="/download/csv/<string:version_date>",
    methods=["GET", "POST"])
def download_csv(version_date):
    """
    Download simulation result CSV files
    <string:version_date> is to download the last zip
    generated after new simulation
    """

    path_zip_result_file = Database.get_file(
        'path_zip_result')['path_zip_result']

    # https://www.youtube.com/watch?v=sy1MNWt7om4
    return send_file(filename_or_fp=path_zip_result_file, as_attachment=True)


@result_blueprint.route(
    rule="/data-visualization/<string:version_date>",
    methods=["GET"])
def data_visualization(version_date):
    """
    Visualizate the HTML generated by R markdown
    <string:version_date> is to visualize the last
    restul.html generate after new simulation
    """

    return render_template('/results/results.html')
